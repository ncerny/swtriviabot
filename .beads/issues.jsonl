{"id":"swtriviabot-0a5","content_hash":"1d370320bbff77bd7dd9bccd16e86ed3d061dd360ed2c66033c0f81394b2d0a7","title":"Fix TestImageService.test_validate_image_url_convenience_function","description":"Test failure: TypeError: object MagicMock can't be used in 'await' expression - issue with async context manager","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:21.829396-06:00","updated_at":"2025-11-05T06:51:16.39512-06:00","closed_at":"2025-11-05T06:51:16.39512-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-185","content_hash":"9308f179fcf0bb41578d474baf8fdefac8bf0efc738965dcfce4ba5e2905f4fd","title":"TASK-001: Create Image Model","description":"Implement the Image dataclass in src/models/image.py with validation methods. Includes url, width, height, format, size_bytes, is_valid, validation_error fields and validate_url(), get_embed_data() methods.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:01.00155-06:00","updated_at":"2025-11-04T15:21:01.969982-06:00","closed_at":"2025-11-04T15:21:01.969982-06:00","dependencies":[{"issue_id":"swtriviabot-185","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:15.067003-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-1cw","content_hash":"49d535d41b310e708f0d5f7767dfd7b31a8cf5b5c89a29466cad3db3b921d47d","title":"Improve image posting logic to hide URLs","description":"Modify the image posting functionality so that image URLs are not displayed in the output. This could involve processing the markdown to replace or hide URL links for images.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-04T14:49:17.761175-06:00","updated_at":"2025-11-04T14:49:17.761175-06:00"}
{"id":"swtriviabot-1wn","content_hash":"d4061ca0285842bd23f7bb122af883602cef995edd02320e43d3ed094c535748","title":"Fix TestImageService.test_validate_and_create_embed_timeout","description":"Test failure: assert 'Image took too long to load' in error message - got context manager protocol error","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:12.443921-06:00","updated_at":"2025-11-05T06:50:41.582658-06:00","closed_at":"2025-11-05T06:50:41.582658-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-3iu","content_hash":"cc29400ce6862d45ebc4eda253975327c0d285a6d866c2cee3f4329c4c82ab91","title":"Fix TestImageService.test_validate_and_create_embed_invalid_url","description":"Test failure: assert 'Please provide a valid image URL' in error message - got GIF search error instead","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:05.321378-06:00","updated_at":"2025-11-05T07:50:36.83144-06:00","closed_at":"2025-11-05T07:50:36.83144-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-3q2","content_hash":"f21b4cd2881eb55354fa0d52ef09d72874ff7b6a7055cb060a1fafa126c2e024","title":"TASK-004: Add Unit Tests","description":"Create comprehensive unit tests for image validation and service methods in tests/unit/test_image_service.py with 90%+ coverage. Tests for valid/invalid URLs, different formats, timeout scenarios.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:07.868677-06:00","updated_at":"2025-11-04T15:21:44.482801-06:00","closed_at":"2025-11-04T15:21:44.482801-06:00","dependencies":[{"issue_id":"swtriviabot-3q2","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:21.08341-06:00","created_by":"daemon"},{"issue_id":"swtriviabot-3q2","depends_on_id":"swtriviabot-tmy","type":"blocks","created_at":"2025-11-04T15:19:34.026227-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-41u","content_hash":"33f8c3457f974cee71750d019bde5045bcb096ee972795d98396b142a7c756f4","title":"Fix TestImageModel.test_process_search_term_no_results - fixture 'service' not found","description":"Test error: fixture 'service' not found - need to make service fixture available to TestImageModel class","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:36.675496-06:00","updated_at":"2025-11-05T06:44:23.461949-06:00","closed_at":"2025-11-05T06:44:23.461949-06:00","labels":["fixture","test-error"]}
{"id":"swtriviabot-6dl","content_hash":"ec2e701c623c6ad9b8299832c3e1c7d53a6ea5654f59d9f5762d3dfb1512843e","title":"Fix TestImageService.test_validate_and_create_embed_large_image","description":"Test failure: assert 'Image is too large' in error message - got context manager protocol error","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:18.369493-06:00","updated_at":"2025-11-05T06:50:43.29258-06:00","closed_at":"2025-11-05T06:50:43.29258-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-87e","content_hash":"f415f0a3a6f4660db67585546aea6320f889a559505bb253127d561cf4d2013f","title":"TASK-005: Add Integration Tests","description":"Create integration tests for end-to-end image posting workflow in tests/integration/test_image_hiding.py. Tests for successful image posting without URL display and error handling.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:09.917884-06:00","updated_at":"2025-11-04T15:21:59.209355-06:00","closed_at":"2025-11-04T15:21:59.209355-06:00","dependencies":[{"issue_id":"swtriviabot-87e","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:24.685687-06:00","created_by":"daemon"},{"issue_id":"swtriviabot-87e","depends_on_id":"swtriviabot-eaj","type":"blocks","created_at":"2025-11-04T15:19:36.166011-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-8c0","content_hash":"4fefbbb0184ae6210ac23e3b46c4ed035c0da30aa46d6a6ebe01ceecee703647","title":"Fix TestImageModel.test_process_search_term_no_api_key - fixture 'service' not found","description":"Test error: fixture 'service' not found - need to make service fixture available to TestImageModel class","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:28.082563-06:00","updated_at":"2025-11-05T06:44:20.125939-06:00","closed_at":"2025-11-05T06:44:20.125939-06:00","labels":["fixture","test-error"]}
{"id":"swtriviabot-8rj","content_hash":"03a8b6ae4372a06b281d368a2c40ab8fe6fe5ae4652b36b5fc28c21c33b7c316","title":"TASK-006: Update Documentation","description":"Update project documentation to reflect new image handling capabilities. Update README.md, API documentation, code comments, and CHANGELOG.md entry for the feature.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:11.896194-06:00","updated_at":"2025-11-04T15:22:23.232971-06:00","closed_at":"2025-11-04T15:22:23.232971-06:00","dependencies":[{"issue_id":"swtriviabot-8rj","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:27.151521-06:00","created_by":"daemon"},{"issue_id":"swtriviabot-8rj","depends_on_id":"swtriviabot-eaj","type":"blocks","created_at":"2025-11-04T15:19:38.204393-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-921","content_hash":"eab87178092934992789ab3868d706547fa4405504ae949b44eade7cbbf9e81b","title":"Add interactive GIF selection from multiple Tenor results","description":"Instead of auto-selecting the first Tenor GIF result, show multiple options (3-5) and let users select via reactions or buttons which GIF to use in their trivia question.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T15:34:41.813466-06:00","updated_at":"2025-11-04T15:39:14.008863-06:00","closed_at":"2025-11-04T15:39:14.008863-06:00"}
{"id":"swtriviabot-bjw","content_hash":"7c35b3b9289ff5fda939103ea358a36e0314dfe9d30e2b944d9bd27b61f9780f","title":"Fix TestImageService.test_validate_and_create_embed_http_error","description":"Test failure: assert 'Image not found (404)' in error message - got context manager protocol error","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:10.912292-06:00","updated_at":"2025-11-05T06:50:30.616119-06:00","closed_at":"2025-11-05T06:50:30.616119-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-coh","content_hash":"75bed08de4aa84a74aa6ccfc7048e2cc038193e1454417f0871247cfe45a61cd","title":"Test issue","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-04T14:43:17.410087-06:00","updated_at":"2025-11-04T14:43:17.410087-06:00"}
{"id":"swtriviabot-eaj","content_hash":"638edca7a5379232fdad5b610c47062e3edeabdc793e93f221ee92a49b58598c","title":"TASK-003: Modify Post Question Command","description":"Update src/commands/post_question.py to use image service for URL hiding. Import and use ImageService, replace direct image posting with embed creation, maintain backward compatibility.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:05.647462-06:00","updated_at":"2025-11-04T15:21:31.483557-06:00","closed_at":"2025-11-04T15:21:31.483557-06:00","dependencies":[{"issue_id":"swtriviabot-eaj","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:19.136051-06:00","created_by":"daemon"},{"issue_id":"swtriviabot-eaj","depends_on_id":"swtriviabot-tmy","type":"blocks","created_at":"2025-11-04T15:19:32.101446-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-emm","content_hash":"bce0e0b2ade7121d57db1a60e7e8b754874e006aff5b46bb5abc66422d63929b","title":"Image Posting System Improvements \u0026 Bug Fixes","description":"## Summary of Improvements Made\n\n### âœ… **Fixed Duplicate \"Yesterday's Answer\" Issue**\n- **Problem**: Bot was sending yesterday's answer twice - once in a separate message and again in the main question message\n- **Solution**: Removed the separate yesterday results message, keeping all information consolidated in the main question message\n- **Result**: Clean, single message with yesterday's results + today's question + answer button\n\n### âœ… **Enhanced Image Detection \u0026 Processing**\n- **Problem**: Tenor URLs posted as plain text weren't being processed correctly\n- **Solution**: Added logic to detect and properly resolve Tenor URLs in text messages using `_resolve_tenor_url()`\n- **Result**: All image types now work: Discord embeds, uploaded attachments, direct image URLs, and Tenor URLs in text\n\n### âœ… **Removed Redundant Instruction Text**\n- **Problem**: \"Please click the button below to submit your answer!\" was cluttering the interface\n- **Solution**: Removed instruction text entirely - the button is self-explanatory\n- **Result**: Clean interface with just the essential information\n\n### âœ… **Improved Permissions \u0026 Error Handling**\n- **Problem**: Permissions checking wasn't comprehensive\n- **Solution**: Updated permissions check to include Manage Messages (optional) and clearer error messages\n- **Result**: Better user guidance when bot lacks required permissions\n\n### âœ… **Added Debug Logging**\n- **Problem**: Hard to diagnose image processing failures\n- **Solution**: Added detailed debug logging for message detection, URL processing, and embed creation\n- **Result**: Easier troubleshooting of edge cases with different image types\n\n## Technical Implementation Details\n\n**Files Modified:**\n- `src/commands/post_question.py` - Main logic improvements\n- `tests/integration/test_image_hiding.py` - Updated tests\n\n**Key Features:**\n- Single comprehensive message (question + yesterday's results)\n- Robust image detection (embeds, attachments, URLs)\n- Tenor GIF support (both embeds and text URLs)\n- Automatic message cleanup\n- Debug logging for troubleshooting\n\n**Status: COMPLETED** - All improvements tested and working correctly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T19:24:54.24139-06:00","updated_at":"2025-11-04T19:24:56.358355-06:00","closed_at":"2025-11-04T19:24:56.358355-06:00","labels":["bugfix","enhancement"],"dependencies":[{"issue_id":"swtriviabot-emm","depends_on_id":"swtriviabot-qp4","type":"blocks","created_at":"2025-11-04T19:24:54.244671-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-iag","content_hash":"247f67653dce1daebb91ba33289a295c9cea190217ac21f122819ce303c4b60b","title":"Add Tenor GIF search integration","description":"Integrate Tenor API to allow users to search for GIFs by typing search terms instead of URLs. Detect input type (URL vs search term) and handle both cases seamlessly.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T15:30:34.631733-06:00","updated_at":"2025-11-04T15:31:41.890546-06:00","closed_at":"2025-11-04T15:31:41.890546-06:00"}
{"id":"swtriviabot-mc7","content_hash":"5eb5c93e92bf6bb0c2fba5e33aeedb188c64bc097e8bfb64bda29028c378b8b2","title":"Fix TestImageModel.test_process_search_term_success - fixture 'service' not found","description":"Test error: fixture 'service' not found - need to make service fixture available to TestImageModel class","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:23.279815-06:00","updated_at":"2025-11-05T06:44:18.538148-06:00","closed_at":"2025-11-05T06:44:18.538148-06:00","labels":["fixture","test-error"]}
{"id":"swtriviabot-mka","content_hash":"37e4ba800c87023cb8ca47e1728eb181bf9e21af45d671beec885fb371b11d61","title":"Fix TestImageService.test_validate_and_create_embed_unsupported_format","description":"Test failure: assert 'Unsupported image format' in error message - got context manager protocol error","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:19.688459-06:00","updated_at":"2025-11-05T06:50:45.097111-06:00","closed_at":"2025-11-05T06:50:45.097111-06:00","labels":["test-failure","unit-test"]}
{"id":"swtriviabot-pt1","content_hash":"8530a1577398d5981f469c2dfa3b8ff9269a86089003f958f8a34d494530c88e","title":"Improve image URL validation error messages","description":"Current error messages are too technical. Users get 'Invalid content type: text/html' when trying to post webpage links instead of direct image URLs. Need more user-friendly messages that guide them to provide direct image links.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-04T15:24:44.692761-06:00","updated_at":"2025-11-04T15:26:46.829351-06:00","closed_at":"2025-11-04T15:26:46.829351-06:00"}
{"id":"swtriviabot-qp4","content_hash":"5e43f17014974c117b8f651c0b1f3efb7cd28d14990830be14abf74eea919588","title":"Implement hide image URLs feature","description":"ðŸŽ¯ **COMPLETED**: Implemented follow-up message image detection system\n\n**Investigation Results:**\n- Original URL hiding approach failed because Discord's Tenor GIF picker creates webpage links (text/html) instead of direct images\n- Users experienced \"Invalid content type: text/html\" errors when trying to use Discord's native GIF picker\n\n**Final Solution:**\n- Removed image URL field from modal completely\n- Implemented follow-up message detection: user posts question, then immediately posts image/GIF\n- Bot automatically detects the image, deletes user's message, and re-posts image as bot\n- 15-second timeout with graceful fallback\n\n**Technical Implementation:**\n- `_wait_for_image_attachment()` detects Discord embeds, Tenor GIFs, and uploaded images\n- Always deletes user's image message to prevent duplication\n- Posts question text, then separate image message from bot\n- Works with all Discord image features (GIF picker, uploads, links)\n\n**Benefits:**\nâœ… Zero modal complexity - natural Discord workflow\nâœ… Works with Discord's native GIF picker (Tenor integration)\nâœ… Clean chat appearance - no URL clutter or duplicates\nâœ… Images appear \"as the bot\" in separate messages\nâœ… Automatic cleanup prevents message spam\n\n**Status: RESOLVED** - Image posting now works seamlessly with Discord's native features.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-04T15:01:26.339723-06:00","updated_at":"2025-11-04T15:59:23.383321-06:00","closed_at":"2025-11-04T15:59:14.888306-06:00","dependencies":[{"issue_id":"swtriviabot-qp4","depends_on_id":"swtriviabot-1cw","type":"related","created_at":"2025-11-04T15:01:28.102903-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-teo","content_hash":"292b9715ee91483d9750e6178f4e4913c1392065d1925194e9a2886e3fa3fca3","title":"Increase test coverage to 80%","description":"Current test coverage is 69.34%, which is below the required 80% threshold. Need to add tests for uncovered code, prioritizing modules with lowest coverage.","acceptance_criteria":"- Overall test coverage \u003e= 80%\n- All tests passing\n- Focus on lowest coverage modules first","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-05T07:50:42.884561-06:00","updated_at":"2025-11-05T07:50:42.884561-06:00","labels":["coverage","testing"]}
{"id":"swtriviabot-tmy","content_hash":"b8bf2a1122e2d16dac7bcadfd452bb0452cdb925bbdb3902cd8ed64f0c081a95","title":"TASK-002: Implement Image Service","description":"Create src/services/image_service.py with async image validation and embed creation. ImageService class with validate_and_create_embed() method using aiohttp for async HTTP validation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-04T15:19:03.380209-06:00","updated_at":"2025-11-04T15:21:12.05134-06:00","closed_at":"2025-11-04T15:21:12.05134-06:00","dependencies":[{"issue_id":"swtriviabot-tmy","depends_on_id":"swtriviabot-qp4","type":"parent-child","created_at":"2025-11-04T15:19:17.011485-06:00","created_by":"daemon"},{"issue_id":"swtriviabot-tmy","depends_on_id":"swtriviabot-185","type":"blocks","created_at":"2025-11-04T15:19:30.096137-06:00","created_by":"daemon"}]}
{"id":"swtriviabot-ugu","content_hash":"67a095a1b53ab43677634acb616e14e0a9bff7caba05e56c853fb4b315b72c35","title":"Fix TestImageHidingIntegration.test_post_question_with_invalid_image","description":"Test failure: assert None is not None - Error message was not sent as expected","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-11-05T06:43:03.781456-06:00","updated_at":"2025-11-05T06:47:14.745501-06:00","closed_at":"2025-11-05T06:47:14.745501-06:00","labels":["integration-test","test-failure"]}
